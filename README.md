# DLC-Detector-with-Language-Customization

è¿™æ˜¯æˆ‘ä»¬ [å·¥ç¨‹å­¦å¯¼è®ºï¼ˆME1221ï¼‰](https://oc.sjtu.edu.cn/courses/84663) è¯¾ç¨‹é¡¹ç›®çš„ç‰ˆæœ¬ç®¡ç†ä»“åº“ï¼Œæœ¬é¡¹ç›®æ—¨åœ¨å®ç°ä¸€ä¸ªåŸºäºCLIPçš„æ”¯æŒè¯­ä¹‰å®¢åˆ¶åŒ–çš„æ™ºèƒ½å…»è€æ‘„åƒå¤´æ¨¡å—çš„ç¡¬ä»¶æ”¯æŒæ€§å¼€å‘ã€åç«¯VLMå¼€å‘ä»¥åŠå‰ç«¯å¼€å‘ã€‚æŠ€æœ¯ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨å¤§è§„æ¨¡è¯­ä¹‰é¢„è®­ç»ƒçš„CLIPæ¨¡å‹ï¼Œé‡‡ç”¨ViTä½œä¸ºè§†è§‰ç¼–ç å™¨ï¼ŒVanilla Transformerä½œä¸ºè¯­ä¹‰ç¼–ç å™¨ï¼Œzero-shotåœ°è¿›è¡Œåœºæ™¯è¯†åˆ«ï¼Œä»è€Œå®ç°é«˜åº¦ä¸ªæ€§åŒ–çš„æ™ºèƒ½åŠŸèƒ½ã€‚

![DLCå…¨æ ˆæŠ€æœ¯æµç¨‹å›¾](./doc_asset/image/DLC.png)

***

## è¿›åº¦ç®¡ç†å°æ¸…å•

TODOï¼š

- [x] ã€1019å‰ã€‘å®ç°infra
- [x] ã€1023å·¦å³ã€‘å†™infraçš„æ–‡æ¡£
- [x] ã€Throughoutã€‘å’•å’•å’•å‘œå‘œå‘œå“‡å“‡å“‡
- [x] ã€1023å·¦å³ã€‘æŠ€æœ¯å¯¹é½ä¼šè®®ï¼ˆè¯¾ä¸Šï¼‰
- ã€å‘¨åº¦è¿›åº¦å®‰æ’ã€‘1030è¯¾å‰
  - [x] ï¼ˆ**wty**ï¼‰æœ¬å‘¨å‚è€ƒè¯¾ä»¶/å»ºè®®ä¹¦/è¯¾ä¸Šè¯´æ˜è´­ä¹°ï¼šæ‘„åƒå¤´ã€æ‘„åƒå¤´æ¶ï¼ˆé¢„ç®—300å…ƒå·¦å³ï¼Œæ³¨æ„é—®è€å¸ˆæŠ¥é”€è§„èŒƒï¼Œæ³¨æ„ç¡®ä¿æ”¯æŒç¼–ç¨‹ï¼Œå°½é‡ä¸è¦é€€è´§/é‡ä¹°ï¼‰ï¼Œä¸‹å‘¨å°½é‡å¸¦æ¥è¯¾å ‚ã€‚
  - [x] ï¼ˆ**whk**ï¼‰å‚è€ƒé¡¹ç›®å»ºè®®ä¹¦è¿›è¡ŒèƒŒæ™¯ç­‰éæŠ€æœ¯éƒ¨åˆ†çš„å†™ä½œæ„æ€ã€‚
  - [x] ï¼ˆ**whkã€wty**ï¼‰å‡å¦‚æœ‰æ„æ„¿è¿›è¡Œå¼€å‘ï¼Œè¯·æŒ‰ç…§æœ¬READMEæ–‡ä»¶çš„â€œç¬¬ä¸€æ­¥â€â€œç¬¬äºŒæ­¥â€â€œç¬¬ä¸‰æ­¥â€è¿›è¡Œç¯å¢ƒé…ç½®ä¸åŸºç¡€æ„å»ºï¼ˆå…³é”®èŠ‚ç‚¹ï¼šcondaçš„å®Œå–„ã€Copilotå¯ä»¥æ˜¾ç¤ºé«˜çº§æ¨¡å‹ï¼Œåˆ›å»ºè‡ªå·±çš„å¼€å‘branchï¼‰ï¼Œä»è€Œæ”¯æŒåç»­çš„å¼€å‘ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å›°éš¾ç”šè‡³æ„Ÿå—åˆ°ç—›è‹¦ï¼Œä¸ç”¨å‹‰å¼º/åç‰¢ï¼Œè¦æ˜¯æ•´ä¸ªè¿‡ç¨‹æ¯”è¾ƒé¡ºåˆ©ï¼Œä¸‹å‘¨å¯ä»¥è®¨è®ºå„è‡ªè´Ÿè´£çš„å¼€å‘éƒ¨åˆ†ã€‚æˆ‘ä»¬çš„å®—æ—¨æ˜¯**ä¸è¦æ„Ÿå—åˆ°åç‰¢**ï¼ˆéå¸¸çœŸè¯šçš„ï¼‰ï¼Œè¦æ˜¯èƒ½å¼€å‘å½“ç„¶æ¬¢è¿ï¼Œè¦æ˜¯æ„Ÿè§‰å¤ªç´¯äº†å®Œå…¨æ²¡å¿…è¦ç¡¬æ’‘ã€‚
  - [x] ï¼ˆ**lxr**ï¼‰å¯¹äºå‰ç«¯ä¸GUIçš„å®ç°è¿›è¡Œåˆæ­¥å°è¯•ä¸æŠ€æœ¯è°ƒç ”ï¼Œåœ¨ä¸‹å‘¨å½¢æˆæ¯”è¾ƒæ˜ç¡®çš„æƒ³æ³•å’Œè®¾è®¡æ€è·¯ã€‚
  - [x] ï¼ˆ**jhy**ï¼‰å¯¹äºPytorchã€NLPã€Vanilla Transformerè¿›è¡Œå›é¡¾ä¸ç†Ÿæ‚‰ï¼ŒæŒæ¡é¡¹ç›®Pipelineï¼Œæ„æ€ç›¸æœºæ”¯æŒæ€§å¼€å‘ã€‚
  - [x] ï¼ˆ**jyy**ï¼‰å°è¯•å¯¹ç°æœ‰çš„CLIPï¼ˆViT + Vanilla Transformerï¼‰å®ç°è¿›è¡Œè¿›ä¸€æ­¥å˜æ¸…ï¼Œå®Œå–„ç°æœ‰çš„æ¥å£å’Œæ³¨å†Œï¼Œæ”¯æŒä¸¤ç«¯çš„å¼€å‘ã€‚
- ã€å‘¨åº¦è¿›åº¦å®‰æ’ã€‘1106è¯¾å‰
  - [ ] ï¼ˆ**wty**ï¼‰ã€äº§å‡ºï¼šè¯·å°†è§†é¢‘è„šæœ¬å‘åœ¨ç¾¤é‡Œï¼ˆè¦æ˜¯æ—¶é—´ä¸Šæœ‰å›°éš¾è¯·åŠæ—¶è¯´ï¼‰ã€‘è®¾è®¡demoè§†é¢‘çš„è„šæœ¬ï¼Œå­¦ä¹ çŸ­å¹³å¿«çš„å­¦æœ¯æ€§è§†é¢‘é£æ ¼ï¼ˆå¯ä»¥ä¸Šä¸€äº›å­¦æœ¯å·¥ä½œçš„é¡¹ç›®ç½‘ç«™çœ‹ä»–ä»¬çš„demoè§†é¢‘é£æ ¼ï¼Œå¯ä»¥åœ¨youtubeä¸Šæœç´¢...ï¼‰
  - [ ] ï¼ˆ**whk**ï¼‰ã€äº§å‡ºï¼šè¯·äº§å‡ºä¸€ä¸ªç»“é¡¹æŠ¥å‘Šçš„æ¡†æ¶ï¼Œç»†åˆ†åˆ°å„çº§ç›®å½•éƒ½æ”¾ä»€ä¹ˆã€‘è¯·å­¦ä¹  $\LaTeX$ ï¼Œå°½é‡èƒ½å¤Ÿç¡®ä¿è¯¾å‰èƒ½å¤Ÿæ¯”è¾ƒç†Ÿç»ƒåœ°ä½¿ç”¨ï¼Œå¹¶ä¸”å‚è€ƒå›½è‡ªç„¶ç­‰åŸºé‡‘é¡¹ç›®çš„ç»“é¡¹æŠ¥å‘Šè®¾è®¡ï¼Œä»¥åŠå‚è€ƒ[ä¼ æ‰¿äº¤å¤§ä¸Šçš„å¾€å¹´è¯¾ç¨‹é«˜åˆ†èµ„æ–™](https://share.dyweb.sjtu.cn/course/16577)è¿›è¡Œæˆ‘ä»¬ç»“é¡¹æŠ¥å‘Šçš„ç»“æ„è®¾è®¡â€”â€”â€”â€”è¿™ä¸ªå·¥ä½œéå¸¸é‡è¦ï¼Œä¼šå¾ˆå¤§å½±å“åˆ°æˆ‘ä»¬çš„æˆç»©ï¼Œè¯·ç¨å¾®èŠ±ä¸€äº›å¿ƒæ€è¿›è¡Œè®¾è®¡ã€‚
  - [ ] ï¼ˆ**lxr**ï¼‰è¯·ç»§ç»­å®ç°å‰ç«¯ä¸GUIï¼Œå¸Œæœ›ã€é¢„è®¡11æœˆ20æ—¥ï¼ˆç¬¬10å‘¨å‘¨å››ï¼‰ä¹‹å‰å®ç°è‡ªå·±éƒ¨åˆ†çš„æ‰€æœ‰åŠŸèƒ½ã€‚æ³¨æ„ï¼Œå¯¹äºè‡ªå·±å¼€å‘éƒ¨åˆ†çš„å†…å®¹ï¼Œè¯·ç•™ä¸‹æ–‡æ¡£ï¼ˆå¯ä»¥å†™åœ¨æœ¬[README](README.md)æ–‡æ¡£çš„æœ€åéƒ¨åˆ†ï¼Œæ¥ç»­åœ¨infraæ–‡æ¡£åé¢ï¼‰ï¼Œä»‹ç»ä¸»è¦çš„åŠŸèƒ½å’Œæ¥å£ï¼Œæ–¹ä¾¿ä¸å…¶ä»–åŒå­¦åä½œå¼€å‘ã€‚
  - [ ] ï¼ˆ**jhy**ï¼‰è¯·å°è¯•ä½¿ç”¨å·²ç»è´­ç½®çš„æ‘„åƒå¤´è¿›è¡Œ`RTSP_stream`çš„å¤„ç†ï¼Œåœ¨æ—¢æœ‰Infraä¸Šå®ç°å®æ—¶è§†é¢‘æµçš„å¤„ç†ï¼Œå¹¶ä¸”ç•™ä¸‹æ–‡æ¡£ï¼ˆä¹Ÿå°±æ˜¯å®Œæˆç›¸æœºæ”¯æŒæ€§å¼€å‘ï¼‰ï¼Œæå‡ºPull Requestã€‚è¦æ˜¯æœ‰å›°éš¾è¯·åŠæ—¶äº¤æµã€‚
  - [ ] ï¼ˆ**jyy**ï¼‰å¤„ç†Pull Requestï¼Œåˆ©ç”¨å’Œä¸²è´¯å½“å‰å®ç°çš„æ¥å£ï¼Œå¯¹ä¸¤ç±»æµçš„ViTï¼ˆEncoderï¼‰debugï¼Œåšå…¼å®¹å¤„ç†ã€‚
- ã€å‘¨åº¦è¿›åº¦å®‰æ’ã€‘ç¬¬ä¹å‘¨å‘¨ä¸‰é«˜æ•°æœŸä¸­è€ƒï¼Œä»¥åŠå­˜åœ¨ä¸€äº›å…¶ä»–è€ƒè¯•ï¼Œç¬¬ä¹å‘¨æœ‰è€ƒè¯•çš„åŒå­¦åœ¨**æœ¬å‘¨(æŒ‡11/06 - 11/13)ä¸å®‰æ’ä»»åŠ¡**ï¼Œè€ƒè¯•åŠ æ²¹~
  - [x] ï¼ˆ**jhy**ï¼‰âœ… å·²å®Œæˆç›¸æœºæ”¯æŒæ€§å¼€å‘ï¼šå®ç°æ‘„åƒå¤´å®æ—¶å½•åˆ¶ã€æœ¬åœ°è§†é¢‘å¤„ç†ã€å›ºå®šé—´éš”æŠ½å¸§åŠŸèƒ½ï¼Œæ‰€æœ‰å‚æ•°å¯é€šè¿‡ `camera_config.yaml` é…ç½®ã€‚
  - [ ] ï¼ˆ**wty**ï¼‰ã€ç¬¬å…«å‘¨ï¼šè¯·å°†è§†é¢‘è„šæœ¬å‘åœ¨ç¾¤é‡Œï¼ˆè¦æ˜¯æ—¶é—´ä¸Šæœ‰å›°éš¾è¯·åŠæ—¶è¯´ï¼‰ã€‘è®¾è®¡demoè§†é¢‘çš„è„šæœ¬ï¼Œå­¦ä¹ çŸ­å¹³å¿«çš„å­¦æœ¯æ€§è§†é¢‘é£æ ¼ï¼ˆå¯ä»¥ä¸Šä¸€äº›å­¦æœ¯å·¥ä½œçš„é¡¹ç›®ç½‘ç«™çœ‹ä»–ä»¬çš„demoè§†é¢‘é£æ ¼ï¼Œå¯ä»¥åœ¨youtubeä¸Šæœç´¢...ï¼‰
  - [ ] ï¼ˆ**whk**ï¼‰ã€ç¬¬å…«å‘¨ï¼šè¯·äº§å‡ºä¸€ä¸ªç»“é¡¹æŠ¥å‘Šçš„æ¡†æ¶ï¼Œç»†åˆ†åˆ°å„çº§ç›®å½•éƒ½æ”¾ä»€ä¹ˆã€‘è¯·å­¦ä¹  $\LaTeX$ ï¼Œå°½é‡èƒ½å¤Ÿç¡®ä¿è¯¾å‰èƒ½å¤Ÿæ¯”è¾ƒç†Ÿç»ƒåœ°ä½¿ç”¨ï¼Œå¹¶ä¸”å‚è€ƒå›½è‡ªç„¶ç­‰åŸºé‡‘é¡¹ç›®çš„ç»“é¡¹æŠ¥å‘Šè®¾è®¡ï¼Œä»¥åŠå‚è€ƒ[ä¼ æ‰¿äº¤å¤§ä¸Šçš„å¾€å¹´è¯¾ç¨‹é«˜åˆ†èµ„æ–™](https://share.dyweb.sjtu.cn/course/16577)è¿›è¡Œæˆ‘ä»¬ç»“é¡¹æŠ¥å‘Šçš„ç»“æ„è®¾è®¡â€”â€”â€”â€”è¿™ä¸ªå·¥ä½œéå¸¸é‡è¦ï¼Œä¼šå¾ˆå¤§å½±å“åˆ°æˆ‘ä»¬çš„æˆç»©ï¼Œè¯·ç¨å¾®èŠ±ä¸€äº›å¿ƒæ€è¿›è¡Œè®¾è®¡ã€‚
  - [ ] ï¼ˆ**lxr**ï¼‰è°ƒæ•´æ‘„åƒå¤´ç›¸å…³çš„è°ƒç”¨æ–¹å¼ï¼Œæ”¹RTSPä¸ºç›´è¿ï¼›æŒ‰ç…§ç°åœ¨é»˜è®¤åˆ†æ”¯çš„æ¥å£çŠ¶å†µè°ƒæ•´ä¸€ä¸‹è‡ªå·±çš„å®ç°ï¼Œæ–¹ä¾¿åç»­å¼€å‘ã€‚
- [x] [è§†é¢‘æ•è·æ¨¡å—](src/core/video_capture.py) â†’ âœ… å·²å®Œæˆï¼ˆæ‘„åƒå¤´å½•åˆ¶ + æœ¬åœ°è§†é¢‘å¤„ç† + æŠ½å¸§ï¼‰
- [ ] é›†æˆæ£€æµ‹å™¨ï¼švideo_capture â†’ detector.detect(frame)
- [ ] [ä¸»ç¨‹åº](main.py) â†’ æ•´åˆæ‰€æœ‰æ¨¡å—



## å†™åœ¨å‰é¢ï¼šç¯å¢ƒé…ç½®ä¸åŸºç¡€æ„å»º

### ç¬¬ä¸€æ­¥ï¼šæ„å»ºVSCodeä¸Python (Conda)å¼€å‘ç¯å¢ƒ

è¯·å‚è€ƒ[è¯¾ä»¶](./doc_asset/doc/Pythonçš„å®‰è£…ä¸ä½¿ç”¨.pptx)å®Œæˆç¯å¢ƒï¼ˆVSCode + Pythonï¼ˆCondaï¼‰ï¼‰çš„é…ç½®ï¼Œè‹¥ä¸­é€”é‡åˆ°é—®é¢˜ï¼ˆæ¯”å¦‚å’ŒC++çš„ç¼–è¯‘å™¨å‘ç”Ÿå¥‡æ€ªçš„å†²çªï¼‰ï¼Œå»ºè®®ä¸è¦ç€æ€¥ï¼Œæè¿°æ¸…æ¥šé—®é¢˜åè¯¢é—®AIã€‚æ­¤å¤„æ„Ÿè°¢[é­ç…Šè€å¸ˆ](https://www.acem.sjtu.edu.cn/faculty/weixuan.html)çš„è¯¾ç¨‹è¯¾ä»¶ï¼Œè¯·ä»…ç”¨äºå‚è€ƒï¼Œå‹¿è¿›è¡ŒäºŒæ¬¡ä¼ æ’­ã€‚

æœ‰å…³pythonè¯­æ³•ï¼Œæˆ‘ç›¸ä¿¡å¼€å‘ç›¸å…³åŒå­¦ä¸éœ€è¦å¤ªå¤šå­¦ä¹ ï¼Œè‹¥æœ‰éœ€è¦ï¼Œå¯ä»¥å‚è€ƒ[å®˜æ–¹æ–‡æ¡£](https://docs.python.org/zh-cn/3/)ä»¥åŠ[èœé¸Ÿæ•™ç¨‹](https://www.runoob.com/python3/python3-tutorial.html)ã€‚

### ç¬¬äºŒæ­¥ï¼šå®ŒæˆGithubå­¦ç”Ÿè®¤è¯å¹¶å¼€å§‹ä½¿ç”¨

è¯·å‚è€ƒ[è¿™ä¸ªæ•™ç¨‹](https://zhuanlan.zhihu.com/p/688730361)å®ŒæˆGithubå­¦ç”Ÿè®¤è¯ï¼Œä¹‹åå°±ä¼šè·å¾—Github Copilotçš„å…è´¹ä½¿ç”¨èµ„æ ¼ã€‚çœ‹èµ·æ¥æœ‰äº›éº»çƒ¦ï¼Œä½†æ˜¯åšå®Œä¹‹åèƒ½å¤Ÿé•¿ä¹…æé«˜ä½ çš„codingç”Ÿäº§åŠ›ï¼ŒAIå†™ä»£ç ç¡®å®æ˜¯å¾ˆé«˜æ•ˆçš„ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”³è¯·å¾ˆå¯èƒ½ä¸èƒ½ä¸€éè¿‡ï¼Œå¯ä»¥é’ˆå¯¹æ€§å†ä¸Šç½‘æœç´¢ä¸è¿‡çš„åŸå› ï¼ˆæ¯”å¦‚é’ˆå¯¹â€œä½ ä¸ºä»€ä¹ˆä¸åœ¨å­¦æ ¡â€çš„é—®é¢˜éœ€è¦ç”¨æµè§ˆå™¨åŠŸèƒ½æ”¹å®šä½ç»çº¬åº¦ä¹‹ç±»ï¼‰ï¼Œç›¸ä¿¡ä½ é‡åˆ°çš„é—®é¢˜æ€»æœ‰äººé‡åˆ°è¿‡å¹¶å†™è¿‡åˆ†äº«ã€‚è¦æ˜¯å®åœ¨ä¸è¡Œå¯ä»¥åœ¨[æ°´æºç¤¾åŒºæœ‰å…³å¸–å­](https://shuiyuan.sjtu.edu.cn/t/topic/405088)ä¸‹ç¤¼è²Œè¯¢é—®ã€‚

åœ¨è·å¾—å­¦ç”Ÿæƒç›ŠåŒ…ä¹‹åï¼Œå°±å¯ä»¥åœ¨VSCodeä¸­ä¸‹è½½copilotç›¸å…³æ’ä»¶ï¼Œå¹¶ä¸”å¼€å§‹ä½¿ç”¨ä»£ç†æ¨¡å¼ç”Ÿæˆå•¦ã€‚æœ‰å…³å¯èƒ½é‡åˆ°çš„Claudeä¸å¯¹ä¸­å›½IPå¼€æ”¾çš„é—®é¢˜ï¼Œå¯ä»¥å‚è€ƒ[è¿™ä¸ªå¸–å­](https://www.xiaohongshu.com/explore/68d10aca000000000b03dcc2?app_platform=android&ignoreEngage=true&app_version=9.3.0&share_from_user_hidden=true&xsec_source=app_share&type=normal&xsec_token=CBCVGWu2SEszJUjiL-Lm3k5EuMaxULXqDBvZOYVc2o-mY=&author_share=1&xhsshare=WeixinSession&shareRedId=ODw5NTc6Oko2NzUyOTgwNjY2OTo3PkdA&apptime=1760021884&share_id=b95fbc0175974ad986e575235df49c27&share_channel=wechat)ã€‚æœ‰å…³å·¥ç¨‹é—®é¢˜ï¼Œæˆ‘å»ºè®®ä½¿ç”¨Claude Sonnet 4.5ï¼Œè¯•éªŒä¸‹æœ‰æœ€å¥½çš„å·¥ç¨‹ä»£ç è¡¨ç°ã€‚

### ç¬¬ä¸‰æ­¥ï¼šå­¦ä¹ Gitå’ŒGithubçš„ä½¿ç”¨æ–¹æ³•

å› ä¸ºç‰ˆæœ¬ç®¡ç†æ˜¯ç ç±»å­¦ç”Ÿç»å¯¹é€ƒä¸å¼€çš„ä¸€ä¸ªé‡è¦è½¯å®åŠ›ï¼Œ**å»ºè®®èŠ±ä¸€ä¸ªä¸‹åˆçš„æ—¶é—´æ²‰ä¸‹å¿ƒæ¥å­¦ä¹ [è¿™ä¸ªæ•™ç¨‹](https://www.runoob.com/git/git-tutorial.html)**ï¼Œå¹¶ä¸”è·Ÿç€æ•²ä¸€éï¼Œä¹‹åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸ä¼šçš„æ—¶å€™é—®AIäº†ã€‚

æ¯”å¦‚ï¼Œåœ¨æˆ‘ç°åœ¨åœ¨åšçš„å¦ä¸€ä¸ªé¡¹ç›®éœ€è¦ç‰ˆæœ¬ç®¡ç†ï¼Œä½†æ˜¯æˆ‘ä¸è®°å¾—ä¸€äº›æ“ä½œæŒ‡ä»¤çš„æ—¶å€™ï¼Œå¯ä»¥è¿™æ ·é—®AIï¼ˆä½†æ˜¯ä½ å¿…é¡»æ¸…æ¥šä½ åœ¨å¹²ä»€ä¹ˆï¼‰ï¼š

```
æˆ‘ç°åœ¨åœ¨æœåŠ¡å™¨ä¸Šçš„`robust_dev`åˆ†æ”¯è¿›è¡Œæ“ä½œï¼Œéœ€è¦å°†åœ¨codeupç®¡ç†çš„`dev`è¿™ä¸ªé»˜è®¤åˆ†æ”¯çš„å†…å®¹åˆå¹¶åˆ°ç°åœ¨çš„åˆ†æ”¯ï¼Œä½†æ˜¯æˆ‘ç°åœ¨çš„åˆ†æ”¯æœ‰5 commitsé¢†å…ˆäºé»˜è®¤åˆ†æ”¯ï¼Œ8 commitsè½åäºé»˜è®¤åˆ†æ”¯ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨æˆ‘æƒ³è¦ä¿ç•™çš„å·®å¼‚ï¼Œä½†æ˜¯åˆæœ‰éœ€è¦æ›´æ–°çš„ã€‚æ­¤å¤–ï¼Œæˆ‘çš„ç¬¬ä¸€ä¸ªå­åˆ†æ”¯çš„ç¬¬ä¸€ä¸ªcommitæ”¾è¿›äº†ä¸éœ€è¦ä¸Šä¼ codeupçš„ã€é‡Œé¢å­˜åœ¨å®é™…æ–‡ä»¶å’Œè½¯é“¾æ¥çš„assetsæ–‡ä»¶å¤¹ï¼Œæˆ‘å¸Œæœ›åœ¨åŒæ­¥å‰å°†å…¶ç§»å‡ºæ¥ï¼ŒåŒæ­¥åå†æ”¾å›å»ï¼Œæˆ‘åº”è¯¥æ€ä¹ˆæ“ä½œï¼Ÿ
```

å½“ä½ è®¤ä¸ºè‡ªå·±å­¦ä¼šäº†Git/Githubçš„åŸºæœ¬æ“ä½œæ—¶ï¼Œè¯·åœ¨é¡¹ç›®ç¾¤é‡Œè¿›è¡Œè¯´æ˜ï¼Œå¹¶ä¸”ç»™å‡ºä½ çš„Githubè´¦æˆ·ï¼Œæˆ‘ä»¬å°†ä¼šé‚€è¯·ä½ åŠ å…¥é¡¹ç›®ï¼Œå¹¶ä¸”ç»™ä½ ä¸€å®šçš„ä¿®æ”¹æƒé™ã€‚åœ¨æ­¤ä¹‹åï¼Œ**è¯·ä½ åœ¨`main`åˆ†æ”¯çš„åŸºç¡€ä¸Šåˆ›å»º`[å§“åé¦–å­—æ¯ç¼©å†™]_dev`ï¼ˆä¾‹å¦‚`jyy_dev`ï¼‰è¡¨ç¤ºè¿™æ˜¯ä½ çš„å¼€å‘åˆ†æ”¯**ã€‚åœ¨åç»­çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬çš„å¼€å‘æ¨¡å¼æ˜¯ï¼Œæ¯ä½åŒå­¦åœ¨è‡ªå·±çš„åˆ†æ”¯ä¸Šè¿›è¡Œå¼€å‘ï¼Œé€‚æ—¶å’Œ`main`åˆ†æ”¯ä¿æŒåŒæ­¥ï¼ˆå³ä»`main`æ‹‰å–æ›´æ–°ï¼‰ï¼Œåœ¨ä½ å®ŒæˆæŸä¸ªåŠŸèƒ½çš„å®ç°åï¼Œè¯·ä½ å…ˆåŒæ­¥åˆ°è‡ªå·±çš„å¼€å‘åˆ†æ”¯ä¸Šï¼Œç„¶åå‘èµ·pull requestï¼Œæˆ‘ï¼ˆé‡‘æŠ‘æ‰¬ï¼‰å°†ä¼šå®¡æ ¸ååˆå¹¶å…¥`main`åˆ†æ”¯ã€‚åŒæ—¶ï¼Œè¯·ä½ åœ¨å®Œæˆè‡ªå·±çš„å¼€å‘éƒ¨åˆ†åå¯¹äº[READMEæ–‡ä»¶](./README.md)è¿›è¡Œæ›´æ–°ï¼Œè¯´æ˜ä½ çš„å®ç°çš„ä¸€äº›ç›¸å…³ä»‹ç»ã€é‡è¦æ¥å£ã€å…¶ä»–å¼€å‘åŒå­¦åº”è¯¥å¦‚ä½•ä½¿ç”¨ä½ çš„æœ€æ–°å®ç°ï¼Œç­‰ç­‰ç­‰ç­‰ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå‡å¦‚æœ‰ä¸€äº›å®é™…ä¸Šå¹¶ä¸éœ€è¦ä½¿ç”¨gitè·Ÿè¸ªä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¯ä»¥å‚è€ƒ[.gitignoreçš„å†™æ³•](https://liaoxuefeng.com/books/git/customize/ignore/index.html)é‡Œé¢çš„æ•™ç¨‹ï¼Œæ¯”å¦‚ä½ å½•åˆ¶äº†ä¸€ä¸ªä¸€ä¸ªGçš„è§†é¢‘ï¼Œä½ è‚¯å®šä¸éœ€è¦ä¸Šä¼ å®ƒï¼Œå‡å¦‚å…¶åœ¨`assets/`æ–‡ä»¶å¤¹ä¸‹ï¼Œå°±å¯ä»¥è€ƒè™‘æŠŠè¿™ä¸ªæ–‡ä»¶å¤¹ä¸€æ•´ä¸ª`ignore`æ‰ã€‚

æœ€åï¼Œæ„Ÿè°¢ä½ å¯¹äºDLCé¡¹ç›®çš„å…´è¶£ï¼æˆ‘ä»¬çœŸè¯šå¸Œæœ›å¤§å®¶èƒ½å¤Ÿå’Œå¹³åº¦è¿‡è¿™é—¨é‡‘è¯¾â€”â€”**ä¸åç‰¢ã€æœ‰æˆé•¿ã€å–œäº¤æœ‹**ã€‚

***

## \[JYY\] é¡¹ç›® Infra ä»‹ç»

é¦–å…ˆï¼Œæˆ‘ï¼ˆé‡‘æŠ‘æ‰¬ï¼‰ä¼šåœ¨åˆ†é…ä»»åŠ¡å‰å®Œæˆä»£ç çš„æ¡†æ¶ï¼Œä¸‹é¢æ˜¯å¯¹äºæ–‡ä»¶ç»“æ„ã€ä»£ç åŠŸèƒ½çš„ä»‹ç»ã€‚ä¸‹é¢çš„ä¸œè¥¿æ˜¯**éœ€è¦ä»”ç»†çœ‹çš„**ï¼Œåœ¨çœ‹å®Œä¹‹åï¼Œå¯ä»¥æŠŠ`main`åˆ†æ”¯çš„è¿™ä¸ªinfra `merge`åˆ°**ä½ çš„å¼€å‘åˆ†æ”¯**ï¼Œå¹¶ä¸”åœ¨æœ¬åœ°è¯»ä¸€è¯»ç¡®åˆ‡çš„æ–‡ä»¶ç»“æ„ã€ ä»£ç æ¡†æ¶ã€‚ä¸€äº›æ“ä½œä¸Šã€å™¨ç‰©ä¸Šçš„è¯´æ˜ï¼Œå¯ä»¥å‚çœ‹[æˆ‘å‡†å¤‡çš„ç¯å¢ƒå…·ä½“é…ç½®æ–‡æ¡£ï¼ˆå»ºè®®condaï¼Œæœ‰é—®é¢˜éšæ—¶ç¾¤é‡Œé—®ï¼‰](./docs/QUICK_REFERENCE.md)â€”â€”è¦æ˜¯è¿™ä¸ªè¿‡ç¨‹è®©ä½ æåº¦ç—›è‹¦ï¼ŒåŒæ ·å¯ä»¥è€ƒè™‘è½¬éå¼€å‘è§’è‰²â€”â€”ä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹è¿˜æ˜¯å¿…è¦çš„ï¼Œå°¤å…¶å¯¹äºåç»­çš„è¯¾ç¨‹å’Œç§‘ç ”è€Œè¨€ï¼ˆä½†æ˜¯å¯¹å¤§ä¸€æ¥è¯´ç¡®å®å¤ªæ—©ï¼ŒçœŸè¯šä¸æ¨èå¾ˆæ—©è¿›ç»„â€”â€”å“å‘€è¯´å¼€å»äº†ï¼Œæ€»ä¹‹ä¸‹é¢çš„ä¸œè¥¿è¯·å¥½å¥½è¯»~ï¼‰ã€‚

### 1. é¡¹ç›®æ¦‚è¿°

#### 1.1 æ ¸å¿ƒåŠŸèƒ½

**åŸºç¡€åŠŸèƒ½**ï¼š
- âœ… å®æ—¶è§†é¢‘æµè¯»å–ä¸å…³é”®å¸§æå–
- âœ… åŸºäºCLIPçš„è¯­ä¹‰å®¢åˆ¶åŒ–äº‹ä»¶æ£€æµ‹
- âœ… è­¦æŠ¥ä¿¡æ¯è¾“å‡º

**æ‹“å±•åŠŸèƒ½**ï¼š
- ğŸ”„ çŸ­ä¿¡APIè­¦æŠ¥é€šçŸ¥
- ğŸ”„ éšç§ä¿æŠ¤ï¼ˆè§†è§‰æ©ç ï¼‰
- ğŸ”„ GUIå‰ç«¯ç•Œé¢
- ğŸ”„ åœºæ™¯è¿ç§»æµ‹è¯•

#### 1.2 è¾“å…¥æºæ”¯æŒ

é¡¹ç›®éœ€è¦æ”¯æŒä¸¤ç±»è¾“å…¥æºï¼Œå‡å­˜æ”¾åœ¨ `assets/` æ–‡ä»¶å¤¹ä¸‹ï¼š

1. **å®æ—¶è§†é¢‘æµ** (`assets/rtsp_streams/`)
   - ä»æµ·åº·å¨è§†ç›¸æœºæ¨¡å—è¯»å–è§†é¢‘æµ
   - æ”¯æŒä¸åŒåˆ†è¾¨ç‡ï¼ˆå¦‚720p, 1080pç­‰ï¼‰
   - å®æ—¶æŠ½å–å…³é”®å¸§è¿›è¡Œå¤„ç†

2. **ç¦»çº¿è§†é¢‘æ–‡ä»¶** (`assets/test_videos/`)
   - é¢„å…ˆå½•åˆ¶çš„æµ‹è¯•è§†é¢‘ï¼ˆmp4, aviç­‰æ ¼å¼ï¼‰
   - ç”¨äºåŠŸèƒ½æµ‹è¯•å’Œæ•ˆæœå±•ç¤º
   - æŒ‰å›ºå®šå¸§ç‡æˆ–åœºæ™¯å˜åŒ–æŠ½å–å…³é”®å¸§

---

### 2. æ–‡ä»¶ç»“æ„è¯´æ˜

```
DLC-Detector-with-Language-Customization/
â”‚
â”œâ”€â”€ assets/                          # è¾“å…¥èµ„æºç›®å½•
â”‚   â””â”€â”€ test_videos/               # æµ‹è¯•è§†é¢‘æ–‡ä»¶
â”‚       â”œâ”€â”€ fall_detection/        # è·Œå€’æ£€æµ‹æµ‹è¯•è§†é¢‘
â”‚       â”œâ”€â”€ fire_detection/        # ç«ç¾æ£€æµ‹æµ‹è¯•è§†é¢‘
â”‚       â””â”€â”€ normal_scenarios/      # æ­£å¸¸åœºæ™¯è§†é¢‘
â”‚
â”œâ”€â”€ config/                         # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ camera_config.yaml         # ç›¸æœºå‚æ•°é…ç½® âœ…
â”‚   â”œâ”€â”€ model_config.yaml          # CLIPæ¨¡å‹é…ç½®
â”‚   â””â”€â”€ detection_config.yaml      # æ£€æµ‹é˜ˆå€¼å’Œåœºæ™¯é…ç½®
â”‚
â”œâ”€â”€ data/                          # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ logs/                      # è¿è¡Œæ—¥å¿—
â”‚   â”œâ”€â”€ models/                    # é¢„è®­ç»ƒæ¨¡å‹å­˜æ”¾
â”‚   â”‚   â””â”€â”€ clip/                  # CLIPæ¨¡å‹æƒé‡
â”‚   â””â”€â”€ outputs/                   # è¾“å‡ºç»“æœ
â”‚       â”œâ”€â”€ alerts/               # è­¦æŠ¥è®°å½•
â”‚       â””â”€â”€ frames/               # æå–çš„å…³é”®å¸§
â”‚
â”œâ”€â”€ src/                           # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                      # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ video_capture.py      # è§†é¢‘æ•è·å’Œå…³é”®å¸§æå– âœ…
â”‚   â”‚   â”œâ”€â”€ clip_detector.py      # CLIPæ¨¡å‹æ£€æµ‹å™¨
â”‚   â”‚   â””â”€â”€ alert_manager.py      # è­¦æŠ¥ç®¡ç†å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                    # æ¨¡å‹ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ clip_wrapper.py       # CLIPæ¨¡å‹å°è£…
â”‚   â”‚   â””â”€â”€ vision_encoder.py     # è§†è§‰ç¼–ç å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ image_processing.py   # å›¾åƒé¢„å¤„ç†
â”‚   â”‚   â”œâ”€â”€ config_loader.py      # é…ç½®åŠ è½½å™¨
â”‚   â”‚   â””â”€â”€ logger.py             # æ—¥å¿—å·¥å…·
â”‚   â”‚
â”‚   â””â”€â”€ alert/                     # è­¦æŠ¥åŠŸèƒ½ï¼ˆæ‹“å±•ï¼‰
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ sms_sender.py         # çŸ­ä¿¡å‘é€
â”‚       â””â”€â”€ notification.py        # é€šçŸ¥ç®¡ç†
â”‚
â”œâ”€â”€ scripts/                       # è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ download_models.py        # ä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹
â”‚   â”œâ”€â”€ test_camera.py            # è§†é¢‘æ•è·æµ‹è¯•è„šæœ¬ âœ…
â”‚   â””â”€â”€ run_demo.py               # è¿è¡Œæ¼”ç¤º
â”‚
â”œâ”€â”€ start_camera.bat               # Windowså¿«æ·å¯åŠ¨è„šæœ¬ âœ…
â”‚
â”œâ”€â”€ tests/                         # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ test_video_capture.py    # è§†é¢‘æ•è·æµ‹è¯•
â”‚   â”œâ”€â”€ test_clip_detector.py    # æ£€æµ‹å™¨æµ‹è¯•
â”‚   â””â”€â”€ test_integration.py       # é›†æˆæµ‹è¯•
â”‚
â”œâ”€â”€ gui/                           # GUIç•Œé¢ï¼ˆæ‹“å±•ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main_window.py            # ä¸»çª—å£
â”‚   â””â”€â”€ settings_panel.py         # è®¾ç½®é¢æ¿
â”‚
â”œâ”€â”€ docs/                          # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ API.md                    # APIæ–‡æ¡£
â”‚   â””â”€â”€ USER_GUIDE.md             # ç”¨æˆ·æŒ‡å—
â”‚
â”œâ”€â”€ requirements.txt               # Pythonä¾èµ–
â”œâ”€â”€ main.py                        # ä¸»ç¨‹åºå…¥å£
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
```

### 3. æŠ€æœ¯å®ç°æ–¹æ¡ˆ

#### 3.1 è§†é¢‘æ•è·ä¸å…³é”®å¸§æå– âœ… [å·²å®ç°]

**æ ¸å¿ƒæ¨¡å—**ï¼š`src/core/video_capture.py`

**é…ç½®æ–‡ä»¶**ï¼š`config/camera_config.yaml`

**åŠŸèƒ½ç‰¹æ€§**ï¼š

1. **æ‘„åƒå¤´å®æ—¶å½•åˆ¶**
   - æ”¯æŒUSBæ‘„åƒå¤´è¿æ¥ï¼ˆç´¢å¼•å¯é…ç½®ï¼‰
   - æŒ‰ **S** é”®å¼€å§‹å½•åˆ¶ï¼ŒæŒ‰ **Q** é”®åœæ­¢
   - è‡ªåŠ¨ä¿å­˜å®Œæ•´è§†é¢‘å’ŒæŠ½å¸§ç»“æœ
   - æ–‡ä»¶å‰ç¼€ï¼š`LIVE_*` 

2. **æœ¬åœ°è§†é¢‘å¤„ç†**
   - è¾“å…¥è§†é¢‘æ–‡ä»¶è·¯å¾„è¿›è¡Œå¤„ç†
   - æŒ‰å›ºå®šæ—¶é—´é—´éš”ï¼ˆé»˜è®¤0.5ç§’ï¼‰æŠ½å¸§
   - è‡ªåŠ¨ä¿å­˜å¤„ç†åè§†é¢‘å’ŒæŠ½å¸§ç»“æœ
   - æ–‡ä»¶å‰ç¼€ï¼š`LOCAL_*`

**å¿«é€Ÿä½¿ç”¨**ï¼š

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
python scripts/test_camera.py

# é€‰æ‹©åŠŸèƒ½ï¼š
# 1 - æ‘„åƒå¤´å½•åˆ¶
# 2 - æœ¬åœ°è§†é¢‘å¤„ç†
```

**æ ¸å¿ƒæ¥å£**ï¼š

```python
from src.core.video_capture import VideoCapture

# åˆ›å»ºå¯¹è±¡ï¼ˆè‡ªåŠ¨ä»é…ç½®æ–‡ä»¶åŠ è½½å‚æ•°ï¼‰
capture = VideoCapture()

# æ‘„åƒå¤´å½•åˆ¶æ¨¡å¼ï¼ˆå«Sé”®å¼€å§‹ã€Qé”®åœæ­¢ï¼‰
capture.start_camera_recording()

# æœ¬åœ°è§†é¢‘å¤„ç†æ¨¡å¼ï¼ˆæç¤ºè¾“å…¥è·¯å¾„ï¼‰
capture.process_local_video()

# é‡Šæ”¾èµ„æº
capture.release()
```

**é…ç½®è¯´æ˜**ï¼ˆ`camera_config.yaml`ï¼‰ï¼š

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `camera_index` | æ‘„åƒå¤´ç´¢å¼• | 1 |
| `target_width` | ç›®æ ‡å®½åº¦ | 1920 |
| `target_height` | ç›®æ ‡é«˜åº¦ | 1080 |
| `extract_interval` | æŠ½å¸§é—´éš”ï¼ˆç§’ï¼‰ | 0.5 |
| `video_save_dir` | è§†é¢‘ä¿å­˜ç›®å½• | D:/Video_Records |
| `frame_save_dir` | æŠ½å¸§ä¿å­˜ç›®å½• | D:/Frames_Analysis |

**è¾“å‡ºæ–‡ä»¶ç»“æ„**ï¼š

```
D:/Video_Records/
â”œâ”€â”€ LIVE_20251106_123456.mp4      # å®æ—¶å½•åˆ¶
â””â”€â”€ LOCAL_20251106_123457.mp4     # æœ¬åœ°è§†é¢‘å¤„ç†

D:/Frames_Analysis/
â”œâ”€â”€ LiveFrame_20251106_123456/    # å®æ—¶å½•åˆ¶æŠ½å¸§
â””â”€â”€ LocalFrame_20251106_123457/   # æœ¬åœ°è§†é¢‘æŠ½å¸§
```

---

#### 3.2 CLIPæ¨¡å‹é›†æˆ

**æ¨¡å‹é€‰æ‹©**ï¼š
- **OpenAI CLIP**: `openai/clip-vit-base-patch32`
- **OpenCLIP**: `laion/CLIP-ViT-B-32-laion2B-s34B-b79K` (æ›´å¤§è§„æ¨¡é¢„è®­ç»ƒ)

**å¿«é€Ÿäº†è§£åŸç†**ï¼š

- [å¿«é€Ÿäº†è§£Transformerï¼ˆä½†æ˜¯è§†é¢‘ä¸­æœ‰ä¸€å¤„é”™è¯¯ï¼‰](https://www.bilibili.com/video/BV1dyW9zsEk1?vd_source=fea757cded14707bcd60c2e78d0c58ba)
- [ç¨å¾®æ…¢é€Ÿä¸€ç‚¹äº†è§£Transformer](https://www.bilibili.com/video/BV1xoJwzDESD?vd_source=fea757cded14707bcd60c2e78d0c58ba)
- [å¿«é€Ÿäº†è§£ViTåŠå…¶åœ¨VLMä¸­çš„ä½œç”¨](https://www.bilibili.com/video/BV1gnWdzSEzY?spm_id_from=333.788.recommend_more_video.0&trackid=web_related_0.router-related-2206146-5nk2d.1761735178765.390&vd_source=d6c101018355a1105cd81c932cad93c4)
- [å†ç¨å¾®æ…¢é€Ÿä¸€ç‚¹äº†è§£Transformerï¼ˆ9ä¸ªè§†é¢‘ï¼‰](https://www.youtube.com/watch?v=aircAruvnKk&list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi)

æ›´è¯¦ç»†çš„äº†è§£å»ºè®®å­¦ä¹ ã€ŠåŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ã€‹å…¨ä¹¦ï¼ˆä»¥åŠä¸€äº›æ›´åŠ å‰ç½®çš„æ•™ç¨‹ï¼‰åå»è¯»åŸè®ºæ–‡ï¼Œé¢„è®¡éœ€è¦ä¸‰ä¸ªæœˆåˆ°ä¸€å¹´çš„è¯¾ä½™æ—¶é—´ï¼Œä¸ç”¨ç€æ€¥ï¼Œè¿™å¹¶ä¸é€‚åˆæœ¬è¯¾ç¨‹é¡¹ç›®çš„è¿›åº¦è®¾ç½®ã€‚è¿™é‡Œåªæ˜¯è¿›è¡Œä¸€äº›é™ˆåˆ—ï¼Œä»¥é£¨æ„Ÿåˆ°å¥½å¥‡çš„åŒå­¦ã€‚

**æ£€æµ‹æµç¨‹**ï¼š

```python
# ä¼ªä»£ç ç¤ºæ„
class CLIPDetector:
    def __init__(self, model_name):
        self.model = load_clip_model(model_name)
        self.processor = load_clip_processor()
    
    def detect(self, image, text_prompts, threshold=0.25):
        """
        image: PIL Image æˆ– numpy array
        text_prompts: List[str], å¦‚ ["a person falling down", "a fire"]
        threshold: ç›¸ä¼¼åº¦é˜ˆå€¼
        
        è¿”å›: Dict[str, float] - {åœºæ™¯: ç›¸ä¼¼åº¦åˆ†æ•°}
        """
        # 1. å›¾åƒç¼–ç 
        image_features = self.encode_image(image)
        
        # 2. æ–‡æœ¬ç¼–ç 
        text_features = self.encode_text(text_prompts)
        
        # 3. è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
        similarities = cosine_similarity(image_features, text_features)
        
        # 4. åˆ¤æ–­æ˜¯å¦è¶…è¿‡é˜ˆå€¼
        results = {}
        for i, prompt in enumerate(text_prompts):
            if similarities[i] > threshold:
                results[prompt] = similarities[i]
        
        return results
```

**æ–‡æœ¬æç¤ºè¯è®¾è®¡**ï¼š

| åœºæ™¯ | è‹±æ–‡æç¤ºè¯ | ä¸­æ–‡æç¤ºè¯ï¼ˆå‚è€ƒï¼‰ |
|------|-----------|-------------------|
| è·Œå€’ | "a person falling down", "an elderly person fallen on the ground" | ä¸€ä¸ªäººæ‘”å€’äº†ï¼Œè€äººå€’åœ¨åœ°ä¸Š |
| ç«ç¾ | "fire in a room", "flames and smoke" | æˆ¿é—´é‡Œç€ç«äº†ï¼Œç«ç„°å’ŒçƒŸé›¾ |
| æ°´æ·¹ | "floor covered with water", "flooding indoors" | åœ°æ¿è¢«æ°´è¦†ç›–ï¼Œå®¤å†…æ·¹æ°´ |
| æ­£å¸¸ | "a person standing normally", "everyday home scene" | äººæ­£å¸¸ç«™ç«‹ï¼Œæ—¥å¸¸å®¶åº­åœºæ™¯ |

**ä¼˜åŒ–æŠ€å·§**ï¼š
- ä½¿ç”¨å¤šä¸ªç›¸ä¼¼æç¤ºè¯å–å¹³å‡å€¼ï¼Œæé«˜é²æ£’æ€§
- å¼•å…¥"æ­£å¸¸åœºæ™¯"ä½œä¸ºå¯¹ç…§ï¼Œä½¿ç”¨å¯¹æ¯”åˆ†æ•°åˆ¤æ–­å¼‚å¸¸

---

#### 3.3 è­¦æŠ¥ç®¡ç†

**è­¦æŠ¥ç­–ç•¥**ï¼š

```python
class AlertManager:
    def __init__(self, config):
        self.thresholds = config['thresholds']
        self.alert_history = []
        self.cooldown_time = 30  # å†·å´æ—¶é—´ï¼ˆç§’ï¼‰
    
    def should_alert(self, detection_results):
        """
        é¿å…é‡å¤è­¦æŠ¥ï¼š
        - åŒä¸€åœºæ™¯åœ¨å†·å´æ—¶é—´å†…ä¸é‡å¤è­¦æŠ¥
        - è¿ç»­Nå¸§æ£€æµ‹åˆ°æ‰è§¦å‘ï¼ˆå¯é€‰ï¼‰
        """
        pass
    
    def trigger_alert(self, scene, confidence):
        """
        è§¦å‘è­¦æŠ¥ï¼š
        - æ‰“å°åˆ°ç»ˆç«¯
        - è®°å½•åˆ°æ—¥å¿—
        - å‘é€çŸ­ä¿¡ï¼ˆå¦‚æœå¯ç”¨ï¼‰
        """
        pass
```

---

#### 3.4 é…ç½®æ–‡ä»¶è®¾è®¡

**`config/detection_config.yaml`**:

```yaml
detection:
  # æ£€æµ‹åœºæ™¯é…ç½®
  scenarios:
    fall:
      enabled: true
      prompts:
        - "a person falling down"
        - "an elderly person fallen on the ground"
      threshold: 0.25
      cooldown: 30  # ç§’
    
    fire:
      enabled: true
      prompts:
        - "fire in a room"
        - "flames and smoke"
      threshold: 0.30
      cooldown: 60
  
  # å…³é”®å¸§æå–
  keyframe:
    method: "interval"  # interval
    interval: 0.5 #æ¯0.5ç§’æå–ä¸€å¸§å…³é”®å¸§

# è­¦æŠ¥é…ç½®
alert:
  print_to_console: true
  save_to_log: true
  sms_enabled: false  # æ‹“å±•åŠŸèƒ½
  sms_contacts:
    - "+86138XXXXXXXX"
```
### 4. å¼€å‘ä¸ä½¿ç”¨è§„èŒƒ

#### 4.1 ä»£ç è§„èŒƒ

- **ç¼–ç æ ‡å‡†**: PEP 8
- **å‘½åè§„èŒƒ**:
  - ç±»å: `PascalCase`
  - å‡½æ•°/å˜é‡: `snake_case`
  - å¸¸é‡: `UPPER_CASE`
- **æ³¨é‡Šè¦æ±‚**:
  - æ¯ä¸ªå‡½æ•°å¿…é¡»æœ‰docstring
  - å¤æ‚é€»è¾‘å¿…é¡»æœ‰è¡Œå†…æ³¨é‡Š
- **ç±»å‹æç¤º**: æ¨èä½¿ç”¨Pythonç±»å‹æ³¨è§£

#### 4.2 é¢„æƒ³ä¸­çš„å¿«é€Ÿå¼€å§‹ï¼ˆæ˜¾ç„¶ç°åœ¨è¿˜æ²¡æœ‰å®ç°å®Œï¼Œå¼€å§‹ä¸äº†ä¸€ç‚¹ï¼‰

##### 4.2.1 ç¯å¢ƒæ­å»º

```bash
# 1. å…‹éš†ä»“åº“
git clone <repo-url>
cd DLC-Detector-with-Language-Customization

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. ä¸‹è½½CLIPæ¨¡å‹
python scripts/download_models.py
```

##### 4.2.2 æµ‹è¯•è§†é¢‘æ•è·æ¨¡å— âœ…

```bash
# æ–¹å¼1ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬ï¼ˆäº¤äº’å¼èœå•ï¼‰
python scripts/test_camera.py

# æ–¹å¼2ï¼šåŒå‡»æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆWindowsï¼‰
# åŒå‡» start_camera.bat

# é€‰æ‹©åŠŸèƒ½ï¼š
# 1 - æ‘„åƒå¤´å½•åˆ¶ï¼ˆæŒ‰Så¼€å§‹ï¼ŒæŒ‰Qåœæ­¢ï¼‰
# 2 - æœ¬åœ°è§†é¢‘å¤„ç†ï¼ˆè¾“å…¥æ–‡ä»¶è·¯å¾„ï¼‰
# 0 - é€€å‡ºç¨‹åº
```

##### 4.2.3 è¿è¡Œä¸»ç¨‹åºï¼ˆå¼€å‘ä¸­ï¼‰

```bash
# ä½¿ç”¨æ‘„åƒå¤´
python main.py --source camera

# ä½¿ç”¨æœ¬åœ°è§†é¢‘
python main.py --source video --path assets/test_videos/fall_detection/test1.mp4
```

---

---

### 5. ç›¸æœºæ”¯æŒæ€§å¼€å‘æ–‡æ¡£ âœ… [JHY]

#### 5.1 æ¨¡å—æ¦‚è¿°

**å¼€å‘åˆ†æ”¯**ï¼š`jhy_dev`  
**æ ¸å¿ƒæ–‡ä»¶**ï¼š
- `src/core/video_capture.py` - è§†é¢‘æ•è·æ ¸å¿ƒæ¨¡å—
- `config/camera_config.yaml` - é…ç½®æ–‡ä»¶
- `scripts/test_camera.py` - æµ‹è¯•è„šæœ¬

#### 5.2 åŠŸèƒ½è¯´æ˜

**æ”¯æŒçš„åŠŸèƒ½**ï¼š
1. âœ… USBæ‘„åƒå¤´å®æ—¶å½•åˆ¶ï¼ˆæŒ‰Så¼€å§‹ï¼ŒæŒ‰Qåœæ­¢ï¼‰
2. âœ… æœ¬åœ°è§†é¢‘æ–‡ä»¶å¤„ç†å’ŒæŠ½å¸§
3. âœ… å›ºå®šæ—¶é—´é—´éš”æŠ½å¸§ï¼ˆé»˜è®¤0.5ç§’ï¼‰
4. âœ… è‡ªåŠ¨ä¿å­˜è§†é¢‘å’ŒæŠ½å¸§ç»“æœ
5. âœ… æ–‡ä»¶å‘½åå‰ç¼€åŒºåˆ†ï¼ˆLIVE/LOCALï¼‰

#### 5.3 ä½¿ç”¨ç¤ºä¾‹

```python
from src.core.video_capture import VideoCapture

# åˆ›å»ºæ•è·å™¨ï¼ˆä»é…ç½®æ–‡ä»¶åŠ è½½å‚æ•°ï¼‰
capture = VideoCapture()

# æ–¹å¼1ï¼šæ‘„åƒå¤´å½•åˆ¶
capture.start_camera_recording()

# æ–¹å¼2ï¼šæœ¬åœ°è§†é¢‘å¤„ç†
capture.process_local_video()

# é‡Šæ”¾èµ„æº
capture.release()
```

#### 5.4 é…ç½®å‚æ•°

ç¼–è¾‘ `config/camera_config.yaml` ä¿®æ”¹å‚æ•°ï¼š

```yaml
camera:
  camera_index: 1        # æ‘„åƒå¤´ç´¢å¼•ï¼ˆ0, 1, 2...ï¼‰
  target_width: 1920     # åˆ†è¾¨ç‡
  target_height: 1080

video:
  extract_interval: 0.5  # æŠ½å¸§é—´éš”ï¼ˆç§’ï¼‰
  codec: 'mp4v'          # è§†é¢‘ç¼–ç 
  default_fps: 30.0      # é»˜è®¤å¸§ç‡

paths:
  video_save_dir: 'D:/Video_Records'
  frame_save_dir: 'D:/Frames_Analysis'
```

#### 5.5 æ¥å£è¯´æ˜

**ä¸»è¦æ–¹æ³•**ï¼š

| æ–¹æ³• | è¯´æ˜ | è¿”å›å€¼ |
|------|------|--------|
| `start_camera_recording()` | å¯åŠ¨æ‘„åƒå¤´å½•åˆ¶æ¨¡å¼ | List[Tuple] |
| `process_local_video()` | å¤„ç†æœ¬åœ°è§†é¢‘æ–‡ä»¶ | List[Tuple] |
| `extract_keyframes(max_frames)` | æå–å…³é”®å¸§ | List[Tuple] |
| `release()` | é‡Šæ”¾èµ„æº | None |

**è¿”å›æ ¼å¼**ï¼š
```python
keyframes = [(frame_index, frame_image), ...]
# frame_index: int - å¸§ç´¢å¼•
# frame_image: np.ndarray - å¸§å›¾åƒæ•°æ®
```

#### 5.6 ä¸‹æ¸¸å¯¹æ¥

**ä¾›å…¶ä»–æ¨¡å—è°ƒç”¨**ï¼š

```python
# åœ¨ä¸»ç¨‹åºæˆ–æ£€æµ‹æ¨¡å—ä¸­
from src.core.video_capture import VideoCapture

capture = VideoCapture()

# å¯åŠ¨æ‘„åƒå¤´å¹¶è·å–å…³é”®å¸§
keyframes = capture.start_camera_recording()

# éå†å…³é”®å¸§è¿›è¡Œæ£€æµ‹
for frame_idx, frame in keyframes:
    # è°ƒç”¨æ£€æµ‹å™¨
    results = detector.detect(frame)
    # å¤„ç†ç»“æœ...
```

**æ³¨æ„äº‹é¡¹**ï¼š
- æŒ‰Qé”®ä¼šåœæ­¢å½•åˆ¶å¹¶è¿”å›å·²æŠ½å–çš„å…³é”®å¸§
- æ‰€æœ‰æ–‡ä»¶è‡ªåŠ¨æŒ‰æ—¶é—´æˆ³å‘½åï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®š
- æ”¯æŒä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼š`with VideoCapture() as cap: ...`

---

- ä¸€äº›å°å°çš„æ•™ç¨‹
  - CLIPå®è·µæ•™ç¨‹: https://huggingface.co/docs/transformers/model_doc/clip
  - OpenCVè§†é¢‘å¤„ç†: https://docs.opencv.org/4.x/dd/d43/tutorial_py_video_display.html

***


---

## \[LXR\] GUI å›¾å½¢ç•Œé¢æ¨¡å—ä»‹ç»

GUIï¼ˆå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼‰æ¨¡å—ä¸ºDLCæ£€æµ‹ç³»ç»Ÿæä¾›äº†ç›´è§‚æ˜“ç”¨çš„å¯è§†åŒ–æ“ä½œç•Œé¢ï¼Œè®©ç”¨æˆ·æ— éœ€ç¼–å†™ä»£ç å³å¯ä½¿ç”¨ç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯GUIæ¨¡å—çš„åŠŸèƒ½è¯´æ˜å’Œä½¿ç”¨æŒ‡å—ã€‚

### 1. GUI æ¨¡å—æ¦‚è¿°

#### 1.1 æ ¸å¿ƒåŠŸèƒ½

**å·²å®ç°åŠŸèƒ½**ï¼š
- âœ… å®æ—¶è§†é¢‘æµé¢„è§ˆï¼ˆæœ¬åœ°æ‘„åƒå¤´ï¼‰
- âœ… è§†é¢‘æ’­æ”¾æ§åˆ¶ï¼ˆå¼€å§‹/æš‚åœ/åœæ­¢ï¼‰
- âœ… åœºæ™¯é…ç½®é¢æ¿
- âœ… è§†é¢‘æ˜¾ç¤ºï¼ˆ60fpsï¼‰

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- ğŸ“¹ **è§†é¢‘é¢„è§ˆ**ï¼šå®æ—¶æ˜¾ç¤ºæœ¬åœ°æ‘„åƒå¤´ç”»é¢ï¼Œæ”¯æŒè‡ªåŠ¨ç¼©æ”¾å’Œå±…ä¸­æ˜¾ç¤º
- ğŸ¬ **åœºæ™¯ç®¡ç†**ï¼šæ”¯æŒè‡ªå®šä¹‰åœºæ™¯ç±»å‹ï¼ˆå¦‚"æ‘”å€’"ã€"èµ·ç«"ç­‰ï¼‰

#### 1.2 æ¨¡å—ç»“æ„

```
gui/
â”œâ”€â”€ __init__.py 
|â”€â”€ kawaii_icon.png         # çª—å£å›¾æ ‡             # åŒ…åˆå§‹åŒ–æ–‡ä»¶
â”œâ”€â”€ main_window.py           # ä¸»çª—å£ï¼ˆè§†é¢‘æ˜¾ç¤ºå’Œæ§åˆ¶ï¼‰
â”œâ”€â”€ settings_panel.py        # è®¾ç½®é¢æ¿ï¼ˆåœºæ™¯é…ç½®ï¼‰
|â€”â€” lxrtest.py                  #lxrè‡ªå·±æµ‹è¯•æ¥å£çš„æ–‡ä»¶/æ²¡å•¥ç”¨

```
---

### 2. ä¸»çª—å£åŠŸèƒ½è¯´æ˜

#### 2.1 ç•Œé¢å¸ƒå±€

ä¸»çª—å£é‡‡ç”¨ç»å…¸çš„å•æ å¸ƒå±€ï¼š
- **é¡¶éƒ¨åŒºåŸŸ**ï¼šå®æ—¶è§†é¢‘é¢„è§ˆç”»å¸ƒï¼ˆ16:9æ¯”ä¾‹ï¼‰
- **åº•éƒ¨åŒºåŸŸ**ï¼šæ§åˆ¶æŒ‰é’®æ ï¼ˆå±…ä¸­æ’åˆ—ï¼‰

#### 2.2 æ§åˆ¶æŒ‰é’®

| æŒ‰é’® | å›¾æ ‡ | åŠŸèƒ½è¯´æ˜ | å¿«æ·é”® |
|------|------|----------|--------|
| å¼€å§‹æ£€æµ‹ | â–¶ | å¯åŠ¨æœ¬åœ°æ‘„åƒå¤´å¹¶å¼€å§‹å®æ—¶æ˜¾ç¤º | - |
| æš‚åœ | â¸ | æš‚åœè§†é¢‘æ’­æ”¾ï¼ˆä¸é‡Šæ”¾æ‘„åƒå¤´èµ„æºï¼‰ | - |
| åœæ­¢ | â¹ | åœæ­¢è§†é¢‘æµå¹¶é‡Šæ”¾æ‰€æœ‰èµ„æº | - |
| è®¾ç½® | âš™ | æ‰“å¼€è®¾ç½®é¢æ¿è¿›è¡Œåœºæ™¯é…ç½® | - |

#### 2.3 è§†é¢‘å¤„ç†æµç¨‹

```
æœ¬åœ°æ‘„åƒå¤´(cv2.VideoCapture)
    â†“
è¯»å–è§†é¢‘å¸§(BGRæ ¼å¼)
    â†“
é¢œè‰²ç©ºé—´è½¬æ¢(BGR â†’ RGB)
    â†“
è°ƒæ•´å¤§å°(ä¿æŒå®½é«˜æ¯”)
    â†“
è½¬æ¢ä¸ºPIL.Image
    â†“
è½¬æ¢ä¸ºImageTk.PhotoImage
    â†“
Canvasæ˜¾ç¤º(60fps, 17ms/å¸§)
```

#### 2.4 çª—å£ç‰¹æ€§

- **è‡ªé€‚åº”ç¼©æ”¾**ï¼šçª—å£å¤§å°æ”¹å˜æ—¶è‡ªåŠ¨è°ƒæ•´è§†é¢‘æ˜¾ç¤ºåŒºåŸŸ
- **ä¿æŒå®½é«˜æ¯”**ï¼šä¸»çª—å£å§‹ç»ˆä¿æŒ16:9çš„å®½é«˜æ¯”
- **å±…ä¸­æ˜¾ç¤º**ï¼šè§†é¢‘ç”»é¢åœ¨ç”»å¸ƒä¸­å±…ä¸­æ˜¾ç¤ºï¼Œå¤šä½™åŒºåŸŸå¡«å……é»‘è‰²
- **é«˜æ€§èƒ½**ï¼š60fpsåˆ·æ–°ç‡

---
### 3. è®¾ç½®é¢æ¿åŠŸèƒ½è¯´æ˜

#### 3.1 é¢æ¿å¸ƒå±€

è®¾ç½®é¢æ¿é‡‡ç”¨å·¦å³åŒæ å¸ƒå±€ï¼š
- **å·¦ä¾§å¯¼èˆªæ **ï¼šåœºæ™¯é…ç½®æŒ‰é’®
- **å³ä¾§å†…å®¹åŒº**ï¼šå…·ä½“é…ç½®é€‰é¡¹

#### 3.2 åœºæ™¯é…ç½®é€‰é¡¹

**åœºæ™¯ç±»å‹ç®¡ç†**ï¼š
- å†…ç½®åœºæ™¯ï¼š`æ‘”å€’`ã€`èµ·ç«`
- æ”¯æŒè‡ªå®šä¹‰æ–°åœºæ™¯
- æ”¯æŒåˆ é™¤è‡ªå®šä¹‰åœºæ™¯ï¼ˆå†…ç½®åœºæ™¯ä¸å¯åˆ é™¤ï¼‰
- æ”¯æŒå¤šé€‰æ£€æµ‹åœºæ™¯

**åœºæ™¯å‚æ•°é…ç½®**ï¼š

| å‚æ•°ç±»åˆ« | é…ç½®é¡¹ | è¯´æ˜ |
|---------|--------|------|
| **åœºæ™¯ç±»å‹** | å¤é€‰æ¡† | é€‰æ‹©å½“å‰è¦é…ç½®çš„åœºæ™¯ |
| **æŠ¥è­¦è®¾ç½®** | å£°éŸ³æŠ¥è­¦/çŸ­ä¿¡é€šçŸ¥ | å¤é€‰æ¡†ï¼Œé…ç½®è­¦æŠ¥æ–¹å¼ |
| **å½•åƒè®¾ç½®** | äº‹ä»¶è§¦å‘æ—¶è‡ªåŠ¨å½•åƒ | å¤é€‰æ¡†ï¼Œæ˜¯å¦åœ¨æ£€æµ‹åˆ°äº‹ä»¶æ—¶å½•åƒ |

**æ“ä½œæŒ‰é’®**ï¼š
- `â• æ–°å»ºåœºæ™¯`ï¼šå¼¹å‡ºå¯¹è¯æ¡†è¾“å…¥æ–°åœºæ™¯åç§°
- `åˆ é™¤åœºæ™¯`ï¼šåˆ é™¤å½“å‰é€‰ä¸­çš„è‡ªå®šä¹‰åœºæ™¯
- `ä¿å­˜åœºæ™¯é…ç½®`ï¼šä¿å­˜å½“å‰é…ç½®åˆ°å†…å­˜

#### 3.3 é…ç½®æŒä¹…åŒ–

è®¾ç½®é¢æ¿çš„é…ç½®æ•°æ®å­˜å‚¨åœ¨ä¸»çª—å£çš„ `app_config` å­—å…¸ä¸­ï¼š

```python
app_config = {
    "scene": {
        "scene_type": "æ‘”å€’",           # å½“å‰åœºæ™¯ç±»å‹
        "enable_sound": True,           # å£°éŸ³æŠ¥è­¦
        "enable_email": False,          # çŸ­ä¿¡é€šçŸ¥
        "auto_record": False,           # è‡ªåŠ¨å½•åƒ
    },
    "scene_types": ["æ‘”å€’", "èµ·ç«"],   # åœºæ™¯ç±»å‹åˆ—è¡¨
}
```

---

### 4. ä¸»è¦æ¥å£è¯´æ˜

#### 4.1 MainWindow ç±»ï¼ˆmain_window.pyï¼‰

**åˆå§‹åŒ–æ–¹æ³•**ï¼š
```python
class MainWindow:
    def __init__(self) -> None:
        """åˆå§‹åŒ–ä¸»çª—å£ï¼Œåˆ›å»ºGUIç»„ä»¶å¹¶å¯åŠ¨äº‹ä»¶å¾ªç¯"""
```

**æ ¸å¿ƒæ–¹æ³•**ï¼š

| æ–¹æ³•å | åŠŸèƒ½è¯´æ˜ |
|--------|----------|
| `_on_start_detection()` | å¼€å§‹æ£€æµ‹æŒ‰é’®å›è°ƒï¼Œå¯åŠ¨æ‘„åƒå¤´ |
| `_on_pause()` | æš‚åœ/æ¢å¤è§†é¢‘æ’­æ”¾ |
| `_on_stop()` | åœæ­¢è§†é¢‘æµå¹¶é‡Šæ”¾èµ„æº |
| `_on_settings()` | æ‰“å¼€è®¾ç½®é¢æ¿ |
| `_start_video_stream()` | å¯åŠ¨è§†é¢‘æ•è·ï¼ˆcv2.VideoCaptureï¼‰ |
| `_stop_video_stream()` | åœæ­¢è§†é¢‘æ•è·å¹¶æ¸…ç†èµ„æº |
| `_update_video_frame()` | æ›´æ–°è§†é¢‘å¸§ï¼ˆ60fpså¾ªç¯è°ƒç”¨ï¼‰ |
| `_resize_frame()` | è°ƒæ•´å¸§å¤§å°ä»¥é€‚åº”ç”»å¸ƒ |

**é‡è¦å±æ€§**ï¼š

| å±æ€§å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `video_capture` | cv2.VideoCapture | OpenCVè§†é¢‘æ•è·å¯¹è±¡ |
| `is_playing` | bool | æ˜¯å¦æ­£åœ¨æ’­æ”¾ |
| `is_paused` | bool | æ˜¯å¦å·²æš‚åœ |
| `app_config` | dict | åº”ç”¨é…ç½®æ•°æ® |

#### 4.2 SettingsPanel ç±»ï¼ˆsettings_panel.pyï¼‰

**åˆå§‹åŒ–æ–¹æ³•**ï¼š
```python
class SettingsPanel:
    def __init__(self, parent: Union[tk.Tk, tk.Toplevel], 
                 app_config: Dict = None) -> None:
        """
        åˆå§‹åŒ–è®¾ç½®é¢æ¿
        
        Args:
            parent: çˆ¶çª—å£å¯¹è±¡
            app_config: åº”ç”¨é…ç½®å­—å…¸ï¼ˆå¼•ç”¨ä¼ é€’ï¼Œä¿®æ”¹ä¼šåŒæ­¥åˆ°ä¸»çª—å£ï¼‰
        """
```

**æ ¸å¿ƒæ–¹æ³•**ï¼š

| æ–¹æ³•å | åŠŸèƒ½è¯´æ˜ |
|--------|----------|
| `show_page(page_name)` | æ˜¾ç¤ºæŒ‡å®šé…ç½®é¡µé¢ |
| `_create_scene_page()` | åˆ›å»ºåœºæ™¯é…ç½®é¡µé¢ |
| `_on_scene_change()` | åœºæ™¯ç±»å‹æ”¹å˜æ—¶çš„å›è°ƒ |
| `_create_new_scene()` | åˆ›å»ºæ–°åœºæ™¯ï¼ˆå¼¹å‡ºè¾“å…¥å¯¹è¯æ¡†ï¼‰ |
| `_delete_current_scene()` | åˆ é™¤å½“å‰é€‰ä¸­çš„åœºæ™¯ |
| `_save_scene_config()` | ä¿å­˜åœºæ™¯é…ç½®åˆ° app_config |


## è·å–ç”¨æˆ·é…ç½®ä¿¡æ¯ï¼Œä½ éœ€è¦çš„æ¥å£ï¼ï¼ï¼ï¼ï¼

### ğŸ“‹ è¯»å–æ¥å£ï¼ˆ7ä¸ªï¼‰

| æ–¹æ³• | ç±»å‹ | åŠŸèƒ½ |
|------|------|------|
| `get_scene_config()` | è¯»å– | è·å–å®Œæ•´åœºæ™¯é…ç½® â­ |
| `get_current_scene_type()` | è¯»å– | è·å–å½“å‰åœºæ™¯ç±»å‹ |
| `get_selected_scenes()` | è¯»å– | è·å–æ‰€æœ‰é€‰ä¸­çš„åœºæ™¯ âœ¨ |
| `get_all_scene_types()` | è¯»å– | è·å–æ‰€æœ‰åœºæ™¯ç±»å‹åˆ—è¡¨ |
| `get_alert_settings()` | è¯»å– | è·å–æŠ¥è­¦è®¾ç½® |

### âœï¸ å†™å…¥æ¥å£ï¼ˆ4ä¸ªï¼‰

| æ–¹æ³• | ç±»å‹ | åŠŸèƒ½ |
|------|------|------|
| `set_scene_type(name)` | ä¿®æ”¹ | åˆ‡æ¢åœºæ™¯ç±»å‹ |
| `set_selected_scenes(list)` | ä¿®æ”¹ | è®¾ç½®å¤šä¸ªé€‰ä¸­åœºæ™¯ âœ¨ æ–°å¢ |
| `update_scene_config(dict)` | ä¿®æ”¹ | æ‰¹é‡æ›´æ–°é…ç½® â­ |
| `add_scene_type(name)` | ç®¡ç† | æ·»åŠ æ–°åœºæ™¯ç±»å‹ |

### ğŸ”” é…ç½®ç›‘å¬æ¥å£ï¼ˆ4ä¸ªï¼‰

| æ–¹æ³• | ç±»å‹ | åŠŸèƒ½ |
|------|------|------|
| `start_config_monitor(callback, ...)` | ç›‘å¬ | å¯åŠ¨é…ç½®ç›‘å¬å™¨ â­ |
| `stop_config_monitor()` | ç›‘å¬ | åœæ­¢é…ç½®ç›‘å¬å™¨ |
| `get_config_snapshot()` | ç›‘å¬ | è·å–é…ç½®å¿«ç…§ |
| `print_current_config()` | ç›‘å¬ | æ‰“å°å½“å‰é…ç½® |

---

### ğŸš€ æ¥å£ä½¿ç”¨ç¤ºä¾‹

#### 1ï¸âƒ£ è¯»å–é…ç½®ç¤ºä¾‹

```python


# æ–¹å¼2ï¼šåªè·å–ç‰¹å®šä¿¡æ¯
scene = gui.settings_panel.get_current_scene_type()
scenes = gui.settings_panel.get_selected_scenes()  # æ–°å¢ï¼šè·å–æ‰€æœ‰é€‰ä¸­åœºæ™¯
alerts = gui.settings_panel.get_alert_settings()

print(f"å½“å‰æ£€æµ‹åœºæ™¯: {scene}")
print(f"æ‰€æœ‰é€‰ä¸­åœºæ™¯: {scenes}")
print(f"å£°éŸ³æŠ¥è­¦: {alerts['sound']}")
print(f"é‚®ä»¶é€šçŸ¥: {alerts['email']}")
```

#### 2ï¸âƒ£ ä¿®æ”¹é…ç½®ç¤ºä¾‹

```python
# æ–¹å¼1ï¼šåˆ‡æ¢å•ä¸ªåœºæ™¯ï¼ˆå‘åå…¼å®¹ï¼‰
gui.settings_panel.set_scene_type("èµ·ç«")

# æ–¹å¼2ï¼šè®¾ç½®å¤šä¸ªåœºæ™¯ï¼ˆæ–°å¢ï¼‰âœ¨
gui.settings_panel.set_selected_scenes(["æ‘”å€’", "èµ·ç«", "é—¯å…¥"])

# æ–¹å¼3ï¼šæ‰¹é‡æ›´æ–°é…ç½®ï¼ˆæ¨èï¼‰
gui.settings_panel.update_scene_config({
    "selected_scenes": ["æ‘”å€’", "èµ·ç«"],  # å¤šåœºæ™¯é€‰æ‹©
    "light_condition": "bright",
    "enable_sound": True,
    "enable_email": True
})

# æ–¹å¼4ï¼šæ·»åŠ è‡ªå®šä¹‰åœºæ™¯
success = gui.settings_panel.add_scene_type("çƒŸé›¾æ£€æµ‹")
if success:
    print("åœºæ™¯æ·»åŠ æˆåŠŸ")
```

#### 3ï¸âƒ£ é…ç½®ç›‘å¬ç¤ºä¾‹ 

```python
from gui.main_window import MainWindow

gui = MainWindow()

# å®šä¹‰é…ç½®å˜åŒ–å›è°ƒå‡½æ•°
def on_config_change(old_config, new_config):
    """å½“ç”¨æˆ·åœ¨GUIä¸­ä¿®æ”¹é…ç½®æ—¶è‡ªåŠ¨è°ƒç”¨"""
    
    # æ£€æµ‹åœºæ™¯æ˜¯å¦å˜åŒ–
    if old_config["scene_type"] != new_config["scene_type"]:
        print(f"åœºæ™¯å·²åˆ‡æ¢: {new_config['scene_type']}")
        # é‡æ–°åŠ è½½æ£€æµ‹æ¨¡å‹...
    
    # æ£€æµ‹å¤šåœºæ™¯é€‰æ‹©å˜åŒ–
    old_scenes = set(old_config["selected_scenes"])
    new_scenes = set(new_config["selected_scenes"])
    if old_scenes != new_scenes:
        print(f"åœºæ™¯åˆ—è¡¨æ›´æ–°: {new_scenes}")
        # ä¸ºæ¯ä¸ªåœºæ™¯åŠ è½½æç¤ºè¯...
    
    # æ£€æµ‹æ‘„åƒå¤´å˜åŒ–
    if old_config.get("camera_id") != new_config.get("camera_id"):
        print(f"æ‘„åƒå¤´åˆ‡æ¢: {new_config['camera_id']}")
        # é‡å¯è§†é¢‘æµ...

# å¯åŠ¨é…ç½®ç›‘å¬
gui.settings_panel.start_config_monitor(
    callback=on_config_change,
    interval=500,              # æ¯500msæ£€æŸ¥ä¸€æ¬¡
    print_changes=True,        # è‡ªåŠ¨æ‰“å°é…ç½®å˜åŒ–
    print_full_config=True     # å˜åŒ–æ—¶æ‰“å°å®Œæ•´é…ç½®
)

# å¯åŠ¨GUI
gui.run()
```

**ç›‘å¬å™¨è¾“å‡ºç¤ºä¾‹**ï¼š
```
ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„
æ£€æµ‹åˆ°é…ç½®å˜åŒ–ï¼
ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„
  ğŸ“Œ æ–°å¢åœºæ™¯: é—¯å…¥
  âš™ï¸  å£°éŸ³æŠ¥è­¦: å¦ â†’ æ˜¯
  âš™ï¸  å…‰ç…§æ¡ä»¶: normal â†’ bright
ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„

============================================================
ğŸ“‹ å½“å‰é…ç½®ä¿¡æ¯:
============================================================
ğŸ¯ å½“å‰åœºæ™¯ç±»å‹: æ‘”å€’
ğŸ“Œ æ‰€æœ‰é€‰ä¸­åœºæ™¯: æ‘”å€’, èµ·ç«, é—¯å…¥

âš™ï¸  é…ç½®å‚æ•°:
   â€¢ ç½®ä¿¡åº¦é˜ˆå€¼: 0.5
   â€¢ æ£€æµ‹é—´éš”: 1.0 ç§’
   â€¢ æ‘„åƒå¤´ID: 0
   â€¢ å‘Šè­¦å»¶è¿Ÿ: 2.0 ç§’

ğŸ¨ åœºæ™¯å‚æ•°:
   â€¢ å£°éŸ³æŠ¥è­¦: æ˜¯
   â€¢ é‚®ä»¶é€šçŸ¥: å¦
   â€¢ è‡ªåŠ¨å½•åƒ: å¦
============================================================
```



### 5. æŠ€æœ¯ç»†èŠ‚

#### 5.1 è§†é¢‘å¸§ç‡ä¼˜åŒ–

- **ç›®æ ‡å¸§ç‡**ï¼š60fps
- **åˆ·æ–°é—´éš”**ï¼š17ms (1000ms / 60fps â‰ˆ 17ms)
- **å®ç°æ–¹å¼**ï¼š`root.after(17, self._update_video_frame)`
- **ç¼“å†²è®¾ç½®**ï¼š`CAP_PROP_BUFFERSIZE = 1`ï¼ˆå‡å°‘å»¶è¿Ÿï¼‰

#### 5.2 é¢œè‰²ç©ºé—´è½¬æ¢

OpenCVé»˜è®¤ä½¿ç”¨BGRæ ¼å¼ï¼Œè€ŒPIL/Tkinterä½¿ç”¨RGBæ ¼å¼ï¼š
```python
frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
```

#### 5.3 å›¾åƒæ ¼å¼è½¬æ¢é“¾

```
numpy.ndarray (OpenCV BGR)
    â†“ cv2.cvtColor()
numpy.ndarray (RGB)
    â†“ Image.fromarray()
PIL.Image
    â†“ ImageTk.PhotoImage()
ImageTk.PhotoImage
    â†“ canvas.create_image()
æ˜¾ç¤ºåœ¨Canvasä¸Š
```

#### 5.4 å†…å­˜ç®¡ç†

å¿…é¡»ä¿æŒPhotoImageçš„å¼•ç”¨ï¼Œå¦åˆ™ä¼šè¢«Pythonåƒåœ¾å›æ”¶ï¼š
```python
self.video_canvas.image = photo  # ä¿æŒå¼•ç”¨
```

#### 5.5 çª—å£ç¼©æ”¾æœºåˆ¶

- ä¸»çª—å£ä¿æŒ16:9å®½é«˜æ¯”
- è®¾ç½®é¢æ¿ä¿æŒ3:2å®½é«˜æ¯”
- ä½¿ç”¨ `<Configure>` äº‹ä»¶ç›‘å¬çª—å£å¤§å°å˜åŒ–
- åŠ¨æ€è°ƒæ•´å‡ ä½•å½¢çŠ¶ä»¥ä¿æŒæ¯”ä¾‹

---

### 6. æ‰©å±•å¼€å‘å»ºè®®

#### 6.1 ä¸æ£€æµ‹æ¨¡å—é›†æˆ

åœ¨ `_update_video_frame()` æ–¹æ³•ä¸­æ·»åŠ æ£€æµ‹è°ƒç”¨ï¼š

```python
def _update_video_frame(self) -> None:
    if not self.is_paused:
        ret, frame = self.video_capture.read()
        if ret:
            # ç°æœ‰çš„æ˜¾ç¤ºé€»è¾‘
            frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
            
            # ğŸ”¥ é›†æˆæ£€æµ‹æ¨¡å—
            if hasattr(self, 'clip_detector'):
                scene_type = self.app_config["scene"]["scene_type"]
                results = self.clip_detector.detect(
                    frame_rgb, 
                    prompts=self._get_prompts_for_scene(scene_type),
                    threshold=0.25
                )
                
                # å¤„ç†æ£€æµ‹ç»“æœ
                if results:
                    self._handle_detection_results(results)
            
            # ç»§ç»­æ˜¾ç¤ºé€»è¾‘...
```

#### 6.2 æ·»åŠ æ£€æµ‹ç»“æœå¼¹çª—ï¼ˆå¾…å®ç°ï¼‰



---


**GUIæ¨¡å—å¼€å‘è€…**: LXR
**æœ€åæ›´æ–°**: 2025å¹´11æœˆ20æ—¥


````

